library(ggplot2)
library(tidyr)
library(nortest)
library(car)

datos = data.frame(
  "nucleos" = rep(c(1,2,3), times=c(27,27,27)),
  "pruebas" = rep(c("fp","dp","oa","fp","dp","oa","fp","dp","oa"), times=c(9,9,9,9,9,9,9,9,9)),
  "tiempo" = c(4.35805320739746,	4.72307205200195,	5.02586364746093,
               4.13823127746582,	5.0361156463623,	4.10628318786621,
               4.09960746765136,	4.01854515075683,	4.1365623474121, 
               4.11248207092285,	4.12225723266601,	4.47821617126464,	
               3.98898124694824,	4.02450561523437,	3.98874282836914,	
               5.0663948059082,	3.98850440979003,	4.02402877807617,	
               5.29384613037109,	4.96077537536621,	4.03094291687011, 
               4.96768951416015,	4.0135383605957,	4.01735305786132,	
               4.98390197753906,	4.02259826660156,	4.02450561523437,	
               2.95448303222656, 9.22441482543945,	6.18577003479003,	
               5.18536567687988,	4.23479080200195,	3.31377983093261,	
               2.94828414916992,	2.9611587524414, 2.95948982238769,	
               3.07941436767578,	3.76391410827636,	2.9611587524414,	
               3.0219554901123,	2.96616554260253,	3.96370887756347, 
               2.99429893493652,	2.99501419067382,	3.96418571472167,	
               4.00257110595703,	2.9914379119873,	3.00812721252441,	
               3.32427024841308, 2.95591354370117,	2.99310684204101,	
               3.07750701904296,	3.00145149230957,	2.9921531677246,	
               2.9919147491455,	8.01825523376464, 8.96430015563964,	
               5.00655174255371,	3.05914878845214,	2.99239158630371,	
               1.96743011474609,	1.99532508850097,	2.00200080871582, 
               3.93295288085937,	1.95908546447753,	1.96599960327148,	
               3.00574302673339,	2.99263000488281,	1.99532508850097,	
               1.97935104370117, 1.99556350708007,	3.00526618957519,	
               3.99065017700195,	2.9919147491455,	3.98612022399902,	
               1.99389457702636,	2.9916763305664, 1.99437141418457,	
               2.99310684204101,	3.98993492126464,	1.99413299560546)
)

datos$nucleos = as.factor(datos$nucleos)
datos$pruebas = as.factor(datos$pruebas)

ggplot(datos, aes(x= nucleos, y= tiempo, fill= pruebas)) + # fill=name allow to automatically dedicate a color for each group
  geom_boxplot()+ labs(x="Núcleos", y= "Tiempo")

shapiro.test(datos$tiempo)

kruskal.test(tiempo~nucleos, data=datos)
kruskal.test(tiempo~pruebas, data=datos)


datos1a = data.frame( #Todas las pruebas 1 núcleo)
  "nucleos" = rep(c(1), times=c(27)),
  "pruebas" = rep(c("fp","dp","oa"), times=c(9,9,9)),
  "tiempo" = c(4.35805320739746,	4.72307205200195,	5.02586364746093,
               4.13823127746582,	5.0361156463623,	4.10628318786621,
               4.09960746765136,	4.01854515075683,	4.1365623474121,
               4.11248207092285,	4.12225723266601,	4.47821617126464,
               3.98898124694824,	4.02450561523437,	3.98874282836914,
               5.0663948059082,	3.98850440979003,	4.02402877807617,	
               5.29384613037109,	4.96077537536621,	4.03094291687011,
               4.96768951416015,	4.0135383605957,	4.01735305786132,	
               4.98390197753906,	4.02259826660156,	4.02450561523437
  ))
shapiro.test(datos1a$tiempo)

kruskal.test(tiempo~pruebas, data=datos1a)

datosfpa = data.frame( # prueba fp todos los núcleos
  "nucleos" = rep(c(1,2,3), times=c(9,9,9)),
  "pruebas" = rep(c("fp"), times=c(27)),
  "tiempo" = c(4.35805320739746,	4.72307205200195,	5.02586364746093,
               4.13823127746582,	5.0361156463623,	4.10628318786621,	
               4.09960746765136,	4.01854515075683,	4.1365623474121, 
               2.95448303222656,	9.22441482543945,	6.18577003479003,	
               5.18536567687988,	4.23479080200195,	3.31377983093261,	
               2.94828414916992,	2.9611587524414,	2.95948982238769, 
               2.9919147491455,	8.01825523376464,	8.96430015563964,	
               5.00655174255371,	3.05914878845214,	2.99239158630371,	
               1.96743011474609,	1.99532508850097,	2.00200080871582

 ))

shapiro.test(datosfpa$tiempo)

kruskal.test(tiempo~nucleos, data=datosfpa)

datos1fp = data.frame(
  "nucleos" = rep(c(1), times=c(9)),
  "pruebas" = rep(c("fp"), times=c(9)),
  "tiempo" = c(4.35805320739746,	4.72307205200195,	5.02586364746093,
               4.13823127746582,	5.0361156463623,	4.10628318786621,
               4.09960746765136,	4.01854515075683,	4.1365623474121

  ))
shapiro.test(datos1fp$tiempo)


datos1dp = data.frame(
  "nucleos" = rep(c(1), times=c(9)),
  "pruebas" = rep(c("dp"), times=c(9)),
  "tiempo" = c(	4.11248207092285,	4.12225723266601,	4.47821617126464,
                3.98898124694824,	4.02450561523437,	3.98874282836914,
                5.0663948059082,	3.98850440979003,	4.02402877807617
               
  ))
shapiro.test(datos1dp$tiempo)

datos2a = data.frame( # Todas las pruebas 2 núcleos
  "nucleos" = rep(c(2), times=c(27)),
  "pruebas" = rep(c("fp","dp","oa"), times=c(9,9,9)),
  "tiempo" = c( 2.95448303222656,	9.22441482543945,	6.18577003479003,
                5.18536567687988,	4.23479080200195,	3.31377983093261,
                2.94828414916992,	2.9611587524414,	2.95948982238769,
                3.07941436767578,	3.76391410827636,	2.9611587524414,
                3.0219554901123,	2.96616554260253,	3.96370887756347,
                2.99429893493652,	2.99501419067382,	3.96418571472167,
                4.00257110595703,	2.9914379119873,	3.00812721252441,
                3.32427024841308,	2.95591354370117,	2.99310684204101,	
                3.07750701904296,	3.00145149230957,	2.9921531677246

  ))
shapiro.test(datos2a$tiempo)
kruskal.test(tiempo~pruebas, data=datos2a)

datosdpa = data.frame( # Prueba dp todos los núcleos
  "nucleos" = rep(c(1,2,3), times=c(9,9,9)),
  "pruebas" = rep(c("dp"), times=c(27)),
  "tiempo" = c(4.11248207092285,	4.12225723266601,	4.47821617126464,	
               3.98898124694824,	4.02450561523437,	3.98874282836914,	
               5.0663948059082,	3.98850440979003,	4.02402877807617, 
               3.07941436767578,	3.76391410827636,	2.9611587524414,	
               3.0219554901123,	2.96616554260253,	3.96370887756347,	
               2.99429893493652,	2.99501419067382,	3.96418571472167, 
               3.93295288085937,	1.95908546447753,	1.96599960327148,	
               3.00574302673339,	2.99263000488281,	1.99532508850097,	
               1.97935104370117,	1.99556350708007,	3.00526618957519
               
  ))

shapiro.test(datosdpa$tiempo)
kruskal.test(tiempo~nucleos, data=datosdpa)

datos2fp = data.frame(
  "nucleos" = rep(c(2), times=c(9)),
  "pruebas" = rep(c("fp"), times=c(9)),
  "tiempo" = c(	2.95448303222656,	9.22441482543945,	6.18577003479003,	
                5.18536567687988,	4.23479080200195,	3.31377983093261,
                2.94828414916992,	2.9611587524414,	2.95948982238769
  ))
shapiro.test(datos2fp$tiempo)

datos2dp = data.frame(
  "nucleos" = rep(c(2), times=c(9)),
  "pruebas" = rep(c("dp"), times=c(9)),
  "tiempo" = c(	3.07941436767578,	3.76391410827636,	2.9611587524414,
                3.0219554901123,	2.96616554260253,	3.96370887756347,	
                2.99429893493652,	2.99501419067382,	3.96418571472167
  ))
shapiro.test(datos2dp$tiempo)

datos3a = data.frame( # Todas las pruebas 3 núcleos
  "nucleos" = rep(c(3), times=c(27)),
  "pruebas" = rep(c("fp","dp","oa"), times=c(9,9,9)),
  "tiempo" = c(2.9919147491455,	8.01825523376464,	8.96430015563964,	
               5.00655174255371,	3.05914878845214,	2.99239158630371,	
               1.96743011474609,	1.99532508850097,	2.00200080871582,	
               3.93295288085937,	1.95908546447753,	1.96599960327148,	
               3.00574302673339,	2.99263000488281,	1.99532508850097,	
               1.97935104370117,	1.99556350708007,	3.00526618957519,	
               3.99065017700195,	2.9919147491455,	3.98612022399902,	
               1.99389457702636,	2.9916763305664,	1.99437141418457,	
               2.99310684204101,	3.98993492126464,	1.99413299560546
  ))
shapiro.test(datos3a$tiempo)
kruskal.test(tiempo~pruebas, data=datos3a)

datosoaa = data.frame( # Prueba oa todos los núcleos
  "nucleos" = rep(c(1,2,3), times=c(9,9,9)),
  "pruebas" = rep(c("oa"), times=c(27)),
  "tiempo" = c(5.29384613037109,	4.96077537536621,	4.03094291687011,	
               4.96768951416015,	4.0135383605957,	4.01735305786132,	
               4.98390197753906,	4.02259826660156,	4.02450561523437, 
               4.00257110595703,	2.9914379119873,	3.00812721252441,	
               3.32427024841308,	2.95591354370117,	2.99310684204101,	
               3.07750701904296,	3.00145149230957,	2.9921531677246, 
               3.99065017700195,	2.9919147491455,	3.98612022399902,	
               1.99389457702636,	2.9916763305664,	1.99437141418457,	
               2.99310684204101,	3.98993492126464,	1.99413299560546
  ))
shapiro.test(datosoaa$tiempo)
kruskal.test(tiempo~nucleos, data=datosoaa)

datos3fp = data.frame(
  "nucleos" = rep(c(3), times=c(9)),
  "pruebas" = rep(c("fp"), times=c(9)),
  "tiempo" = c(	2.9919147491455,	8.01825523376464,	8.96430015563964,	
                5.00655174255371,	3.05914878845214,	2.99239158630371,	
                1.96743011474609,	1.99532508850097,	2.00200080871582
  ))
shapiro.test(datos3fp$tiempo)

datos3dp = data.frame(
  "nucleos" = rep(c(3), times=c(9)),
  "pruebas" = rep(c("dp"), times=c(9)),
  "tiempo" = c(	3.93295288085937,	1.95908546447753,	1.96599960327148,	
                3.00574302673339,	2.99263000488281,	1.99532508850097,	
                1.97935104370117,	1.99556350708007,	3.00526618957519
  ))
shapiro.test(datos3fp$tiempo)
